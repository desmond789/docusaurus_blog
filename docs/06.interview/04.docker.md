---
title: 4.Docker面试题
---
## docker运行的服务器磁盘占用满了，怎么解决

**清理不需要的容器和镜像：**

* 使用 `docker ps -a`命令查看所有容器，使用 `docker rm`命令删除不需要的容器。
* 使用 `docker images`命令查看所有镜像，使用 `docker rmi`命令删除不需要的镜像。

```
# 删除所有停止的容器
docker container prune

# 删除所有未被使用的镜像
docker image prune -a
#或者
sudo docker rmi $(docker images -qa)
```

**清理Docker日志：**

* Docker的日志文件可能占用较多空间。你可以使用以下命令删除旧的Docker日志文件：

```
sudo find /var/lib/docker/containers -type f -name "*.log" -delete
```

**调整Docker日志大小限制：**

* 在Docker配置中，可以调整日志的大小和保存的天数，以限制日志文件占用的空间。编辑Docker的配置文件（通常是 `/etc/docker/daemon.json`），添加或修改以下配置：

```
{
  "log-driver": "json-file",
  "log-opts": {
    "max-size": "10m",
    "max-file": "3"
  }
}
```

这会将每个日志文件的最大大小限制为10MB，最多保留3个日志文件。

**查找大文件并删除：**

* 使用 `du`命令查找占用磁盘空间较大的文件或目录，并根据需要删除它们。

```
# 以磁盘使用量从大到小列出文件和目录
sudo du -h --max-depth=1 / | sort -rh
```

**分析磁盘使用情况：**

* 使用工具如 `ncdu`、`du`等来分析磁盘使用情况，找到占用大量空间的文件或目录。

```
# 使用ncdu工具进行交互式磁盘使用分析
sudo dnf install ncdu
ncdu /
```

**考虑扩展磁盘容量：**

* 如果上述操作无法解决问题，可能需要考虑扩展磁盘容量或者将数据迁移到其他存储设备。

## docker容器挂了怎么查看问题

### 使用健康检查

如果容器中包含健康检查脚本，可以使用 `docker inspect` 命令来查看容器的健康状态。

```
docker inspect --format='{{json .State.Health}}' <container_id_or_name>
```

健康检查脚本通常在 Dockerfile 中使用 `HEALTHCHECK` 指令定义。

### 查看 Docker 事件

使用 `docker events` 命令查看 Docker 的事件流，以获取容器的相关事件信息。

```
docker events

```

### 检查 Docker 守护进程日志

查看 Docker 守护进程的日志文件，通常在 `/var/log/docker.log` 或 `/var/log/syslog` 等位置。这有助于了解 Docker 守护进程本身是否出现问题。

## 运行容器的服务器性能除了top free等命令，还有什么观察手段
